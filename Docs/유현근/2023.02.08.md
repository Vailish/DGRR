# aws

sudo apt-get update

**`netstat -lntp`**

도커 설치

1.

sudo apt-get install \
ca-certificates \
curl \
gnupg \
lsb-release

2.

sudo apt-get install docker-ce-cli [containerd.io](http://containerd.io/) docker-compose-plugin

1. sudo mkdir -p /etc/apt/keyrings
2. curl -fsSL [https://download.docker.com/linux/ubuntu/gpg](https://download.docker.com/linux/ubuntu/gpg) | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
3.

echo \
"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] [https://download.docker.com/linux/ubuntu](https://download.docker.com/linux/ubuntu) \
$(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

1. sudo apt-get install docker-ce docker-ce-cli [containerd.io](http://containerd.io/) docker-compose-plugin

sql

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f5172392-cc4a-4123-b11d-7dc2e49d42b6/Untitled.png)

nginx

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/913455ac-a3de-47b3-a1a2-621251e44883/Untitled.png)

Certbot

**$**

sudo add-apt-repository ppa:certbot/certbot

**$**

sudo apt-get install python3-certbot-nginx

sudo certbot --nginx -d [i8b102.p.ssafy.io](http://i8b102.p.ssafy.io/)

도커 실행

docker run -d -i -t --name front-deploy -p 3000:3000 bbe2589c4576

**openvidu On premises 설치**

```
# 관리자 권한
$ sudo su

# openvidu가 설치되는 경로
$ cd /opt

# openvidu on promises 설치
$ curl https://s3-eu-west-1.amazonaws.com/aws.openvidu.io/install_openvidu_latest.sh | bash

$ exit
$ cd openvidu
```

### openvidu 설정 변

sudo rm -rf certificates

### openvidu-insecure-react 실행

```
$ docker run -p 8443:8443--rm -e OPENVIDU_SECRET=MY_SECRET openvidu/openvidu-server-kms:2.19.0
```

### openvidu On Promises 실행

```
# /opt/openvidu$ ./openvidu start

# 종료할 때는 같은 경로에서$ ./openvidu stop을 하면 된다.
```

### 접속 확인

./openvidu start가 정상적으로 실행되면 마지막에 openvidu의 접속 uri가 나온다.

sudo docker exec -it

docker file

```docker
FROM openjdk:17-alpine

ARG JAR_FILE=build/libs/*.jar

COPY ${JAR_FILE} app.jar

EXPOSE 8080

ENTRYPOINT ["java", "-jar", "/app.jar"]
```

```docker
FROM nginx:stable-alpine

WORKDIR /app

RUN mkdir ./build

ADD ./build ./build

RUN rm /etc/nginx/conf.d/default.conf

COPY ./nginx.conf /etc/nginx/conf.d

EXPOSE 3000

CMD ["nginx", "-g", "daemon off;"]
```

nginx.conf

```
server {
    listen 3000;
    location / {
        root /app/build;
        index index.html;
        try_files $uri $uri/ /index.html;
    }
}
```

spring 도커 설정

docker build -t yuhyeongeun/dgrr:spring-deploy . - 빌드

docker push yuhyeongeun/dgrr:spring-deploy -허브 push

yuhyeongeun/dgrr:spring-deploy -우분투 pull
